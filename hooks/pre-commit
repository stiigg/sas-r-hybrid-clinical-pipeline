#!/usr/bin/env bash
set -euo pipefail

if grep -RInE '(/home/|/Users/|C:\\\\|~/|/mnt/|[A-Za-z]:\\\\)' --exclude-dir=.git --exclude-dir=output --exclude-dir=hooks .; then
  echo "ERROR: Found absolute path literals. Use config variables." >&2
  exit 1
fi

if find . -maxdepth 2 -name '*.R' -print -quit >/dev/null; then
  if [ ! -f renv.lock ]; then
    echo "ERROR: renv.lock missing. Run renv::snapshot() and commit." >&2
    exit 1
  fi
fi

exit 0
